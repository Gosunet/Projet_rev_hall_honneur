<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<title>A-FRAME : Basic scene</title>
	<style>
		canvas {
			width: 100%;
			height: 100%;
			padding: 0;
			margin: 0;
			overflow: hidden;
		}
	</style>
	<script src="dist/aframe-master.min.js"></script>
</head>

<body>

	<a-scene id="scene">
		<a-camera position="0 0.5 20"></a-camera>
		<a-assets>
			<a-mixin id="box" geometry="primitive: box ; depth: 2; height: 2; width:2"></a-mixin>
			<a-asset-item id="statue-obj" src="assets/modeles/statue/statue.obj"></a-asset-item>
			<a-asset-item id="statue-mtl" src="assets/modeles/statue/statue.mtl"></a-asset-item>

			<a-asset-item id="maison-obj" src="assets/modeles/maison/maison.obj"></a-asset-item>
			<a-asset-item id="maison-mtl" src="assets/modeles/maison/maison.mtl"></a-asset-item>

			<a-asset-item id="penguin-obj" src="assets/modeles/penguin/penguin.obj"></a-asset-item>
			<a-asset-item id="penguin-mtl" src="assets/modeles/penguin/penguin.mtl"></a-asset-item>

			<a-asset-item id="billard_room-obj" src="assets/modeles/billard_room/billard_room.obj"></a-asset-item>
			<a-asset-item id="billard_room-mtl" src="assets/modeles/billard_room/billard_room.mtl"></a-asset-item>

		</a-assets>



		<!-- mur de gauche -->
		<a-plane rotation="0 90 0" position="-3.2 2.5 0" height="5" width="4.99" color="#FFF" scale="" visible="" material="side: double; src: url(assets/textures/plafonds.jpg) repeat: 1 1"
		    geometry=""></a-plane>

		<a-plane rotation="0 90 0" position="-3 2.5 -2.78" height="5" width="0.6" color="#CBC" scale="" visible="" material="side: double; src: url(assets/textures/pierre.jpg) repeat: 1 1"
		    geometry=""></a-plane>
		<a-plane rotation="0 0 0" position="-3.1 2.5 -2.49" height="5" width="0.2" color="#CBC" scale="" visible="" material="side: double; src: url(assets/textures/pierre.jpg) repeat: 1 1"
		    geometry=""></a-plane>

		<a-plane rotation="0 -90 0" position="3 2.5 -2.78" height="5" width="0.6" color="#CBC" scale="" visible="" material="side: double; src: url(assets/textures/pierre.jpg) repeat: 1 1"
		    geometry=""></a-plane>
		<a-plane rotation="0 0 0" position="3.1 2.5 -2.49" height="5" width="0.2" color="#CBC" scale="" visible="" material="side: double; src: url(assets/textures/pierre.jpg) repeat: 1 1"
		    geometry=""></a-plane>
		<!-- mur entrée -->
		<a-plane rotation="0 180 0" position="-2.45 2.5 2.49" height="5" width="1.5" color="#FFF" scale="" visible="" material="side: double; src: url(assets/textures/pierre.jpg) repeat: 1 1"
		    geometry=""></a-plane>
		<a-plane rotation="0 180 0" position="2.45 2.5 2.49" height="5" width="1.5" color="#FFF" scale="" visible="" material="side: double; src: url(assets/textures/pierre.jpg) repeat: 1 1"
		    geometry=""></a-plane>
		<a-plane rotation="0 0 0" position="-2.45 2.5 2.49" height="5" width="1.5" color="#FFF" scale="" visible="" material="side: double; src: url(assets/textures/pierre.jpg) repeat: 1 1"
		    geometry=""></a-plane>
		<a-plane rotation="0 0 0" position="2.45 2.5 2.49" height="5" width="1.5" color="#FFF" scale="" visible="" material="side: double; src: url(assets/textures/pierre.jpg) repeat: 1 1"
		    geometry=""></a-plane>
		<!-- porte entrée -->
		<a-plane rotation="0 180 0" position="0 2.125 8.8" height="5.75" width="5" color="#FFF" scale="" visible="" material="side: double; src: url(assets/textures/porte_entree.jpg) repeat: 1 1"
		    geometry=""></a-plane>
		<a-plane rotation="0 0 0" position="3 5.5 8.81" height="30" width="60" color="#FFF" scale="" visible="" material="side: double; src: url(assets/textures/facade.jpg) repeat: 1 1"
		    geometry=""></a-plane>


		<!-- mur ESCALIER -->
		<a-plane rotation="0 -90 0" position="1.7 2.5 2.95" height="5" width="0.92" color="#FFF" scale="" visible="" material="side: double; src: url(assets/textures/pierre.jpg) repeat: 0.01 0.01"
		    geometry=""></a-plane>
		<a-plane rotation="0 90 0" position="-1.7 2.5 2.95" height="5" width="0.92" color="#FFF" scale="" visible="" material="side: double; src: url(assets/textures/pierre.jpg) repeat: 0.01 0.01"
		    geometry=""></a-plane>

		<a-plane rotation="0 0 0" position="2.09 2.5 3.41" height="5" width="0.8" color="#FFF" scale="" visible="" material="side: double; src: url(assets/textures/pierre.jpg) repeat: 0.01 0.01"
		    geometry=""></a-plane>
		<a-plane rotation="0 0 0" position="-2.09 2.5 3.41" height="5" width="0.8" color="#FFF" scale="" visible="" material="side: double; src: url(assets/textures/pierre.jpg) repeat: 0.01 0.01"
		    geometry=""></a-plane>

		<a-plane rotation="0 90 0" position="-2.48 2.125 6.1" height="5.75" width="5.4" color="#FFF" scale="" visible="" material="side: double; src: url(assets/textures/plafonds.jpg) repeat: 1 1"
		    geometry=""></a-plane>
		<a-plane rotation="0 -90 0" position="2.50 2.125 6.1" height="5.75" width="5.4" color="#FFF" scale="" visible="" material="side: double; src: url(assets/textures/plafonds.jpg) repeat: 1 1"
		    geometry=""></a-plane>
		<!-- fenetre -->
		<a-plane rotation="0 90 0" position="-2.47 3.125 6.1" height="4" width="1.5" color="#FFF" scale="" visible="" material="side: double; src: url(assets/textures/fenetre.jpg) repeat: 1 1"
		    geometry=""></a-plane>
		<a-plane rotation="0 -90 0" position="2.49 3.125 6.1" height="4" width="1.5" color="#FFF" scale="" visible="" material="side: double; src: url(assets/textures/fenetre.jpg) repeat: 1 1"
		    geometry=""></a-plane>

		<!-- 	 <a-plane rotation="0 0 0" position="3.1 2.5 -2.49" height="5" width="0.2" color="#CBC" scale="" visible="" material="" geometry=""></a-plane> -->

		<!-- le sol -->
		<a-plane rotation="-90 0 0" position="0 0 0" height="4.99" width="6.40" color="#FFF" scale="" visible="" material="side: double; src: url(assets/textures/tapis2.jpg) repeat: 1 1"
		    geometry=""></a-plane>
		<a-plane rotation="-90 0 0" position="0 0 -2.79" height="0.6" width="6.00" color="#FFF" scale="" visible="" material="side: double; src: url(assets/textures/marbremarche.jpg) repeat: 1 1"
		    geometry=""></a-plane>

		<!-- plafond -->
		<a-plane rotation=" 90 0 0" position="0 5 0" height="4.99" width="6.40" color="#FFF" scale="" visible="" material="side: double; src: url(assets/textures/plafond2.jpg) repeat: 1 1"
		    geometry=""></a-plane>
		<a-plane rotation=" 90 90 0" position="0 5 -2.79" height="6" width="0.6" color="#FFF" scale="" visible="" material="side: double; src: url(assets/textures/pierre.jpg) repeat: 1 1"
		    geometry=""></a-plane>
		<a-plane rotation="90 0 0" position="0 5 5.6" height="6.3" width="5" color="#FFF" scale="" visible="" material="side: double; src: url(assets/textures/plafond.jpg) repeat: 1 1"
		    geometry=""></a-plane>;

		<!-- ESCALIER -->

		<a-plane rotation="-90 0 0" position="0 0 2.95" height="0.92" width="3.4" color="#FFF" scale="" visible="" material="side: double; src: url(assets/textures/marbremarche.jpg) repeat: 1 1"
		    geometry=""></a-plane>;

		<a-plane rotation="-90 0 0" position="0 0 3.7" height="0.60" width="5" color="#FFF" scale="" visible="" material="side: double; src: url(assets/textures/marche1.png) repeat: 0.1 0.1"
		    geometry=""></a-plane>;

		<a-plane rotation="0 0 0" position="0 -0.125 4" height="0.25" width="5" color="#FFF" scale="" visible="" material="side: double; src: url(assets/textures/marche11.png) repeat: 0.1 0.1"
		    geometry=""></a-plane>;
		<a-plane rotation="-90 0 0" position="0 -0.25 4.3" height="0.6" width="5" color="#FFF" scale="" visible="" material="side: double; src: url(assets/textures/marche2.png) repeat: 0.1 0.1"
		    geometry=""></a-plane>;

		<a-plane rotation="0 0 0" position="0 -0.375 4.6" height="0.25" width="5" color="#FFF" scale="" visible="" material="side: double; src: url(assets/textures/marche33.png) repeat: 0.1 0.1"
		    geometry=""></a-plane>;
		<a-plane rotation="-90 0 0" position="0 -0.5 4.9" height="0.6" width="5" color="#FFF" scale="" visible="" material="side: double; src: url(assets/textures/marche3.png) repeat: 0.1 0.1"
		    geometry=""></a-plane>;

		<a-plane rotation="0 0 0" position="0 -0.625 5.2" height="0.25" width="5" color="#FFF" scale="" visible="" material="side: double; src: url(assets/textures/marche22.png) repeat: 0.1 0.1"
		    geometry=""></a-plane>;
		<a-plane rotation="-90 0 0" position="0 -0.75 7" height="3.6" width="5" color="#FFF" scale="" visible="" material="side: double; src: url(assets/textures/tapis.jpg) repeat: 100 20"
		    geometry=""></a-plane>;


		<a-obj-model id="statue" src="#statue-obj" mtl="#statue-mtl" rotation="0 90 0" scale="10 10 10" position="0 0 0">

		<a-obj-model id="maison" src="#maison-obj" mtl="#maison-mtl" rotation="0 -90 0" scale="0.1 0.1 0.1" position="-0.25 0 0.34">
		</a-obj-model>

		<a-obj-model id="penguin" src="#penguin-obj" mtl="#penguin-mtl" rotation="-90 0 0" position="-0.5 0 0 " scale="0.1 0.1 0.1">
		</a-obj-model>

		<a-obj-model id="Piece_billard-1" src="#billard_room-obj" mtl="#billard_room-mtl" rotation="0 -90 0" position="0.9 0.0 -0.10"
		    scale="0.001 0.001 0.001"></a-obj-model>
		<a-entity id="cible00" position="10 0 10">
			<a-sphere radius="0.5" tranparent opacity="0.5" color="#FFFF00"></a-sphere>
		</a-entity>

		<a-entity id="cible01" position="15 0 10">
			<a-sphere radius="0.5" tranparent opacity="0.5" color="#FFFF00"></a-sphere>
		</a-entity>

		<a-entity id="cible02" position="15 0 0">
			<a-sphere radius="0.5" tranparent opacity="0.5" color="#FFFF00"></a-sphere>
		</a-entity>

		<a-entity id="cible03" position="5 0 0">
			<a-sphere radius="0.5" tranparent opacity="0.5" color="orange"></a-sphere>
		</a-entity>
	</a-scene>

	<script src="scripts/Guide.js"></script>
	<script src="js/vec3.js"></script>
	<script>
		var scene = document.querySelector('a-scene');

		alert("PRET ? ");

		var tux00 = document.getElementById('penguin');

		var update_fct = function () {
			var cible = document.getElementById(this.chemin[this.idx]);
			var C = cible.getAttribute("position");
			var P = this.gr.getAttribute('position');


			var Fs = vec3Creer();
			vec3Moins(Fs, C, P);
			var distance = vec3Norme(Fs);
			vec3Normaliser(Fs);

			if (distance < 0.25) {
				if (this.idx == this.chemin.length - 1) {} else {
					this.idx++;
					cible = document.getElementById(this.chemin[this.idx]);
					var C = cible.getAttribute("position");
				}
			}

			var k = 1.0;

			if (this.idx == this.chemin.length - 1)
				if (distance < 2.0)
					k = distance / 2.0;

			vec3Scale(Fs, k * this.vMax);
			vec3Moins(Fs, Fs, this.vitesse);

			var l = vec3Norme(Fs);
			vec3Normaliser(Fs);
			vec3Scale(Fs, Math.min(l, this.fMax));

			vec3Accumuler(P, 0.2, this.vitesse);

			vec3Accumuler(this.vitesse, 0.2, Fs);
			this.vit = vec3Norme(this.vitesse);

			this.gr.setAttribute('position', P);

			if (this.vit > 0.00001) {
				var rot = this.gr.getAttribute('rotation');
				var angleRadian = Math.atan2(-this.vitesse.z, this.vitesse.x);
				rot.y = angleRadian * 180.0 / Math.PI;
				this.gr.setAttribute('rotation', rot);
			}
		}
		tux0 = {
			cap: 0.0,
			vit: 0.05,
			vMax: 0.5,
			fMax: 0.1,
			vitesse: {
				x: 0.05 * Math.cos(0.0),
				y: 0.0,
				z: 0.05 * Math.sin(0.0)
			},
			acceleration: {
				x: 0.0,
				y: 0.0,
				z: 0.0
			},
			chemin: ["cible00", "cible01", "cible02", "cible03"],
			idx: 0,
			gr: tux00,
			update: update_fct
		};
		setInterval(anim, 20);


		function anim() {
			tux0.update();
		}
	</script>

</body>

</html>
